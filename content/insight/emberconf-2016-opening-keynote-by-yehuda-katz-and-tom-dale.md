+++
date = "2016-04-30T00:00:00+08:00"
title = "EmberConf 2016 开场演讲阅后感"
description = ""
categories = ["洞见"]
tags = ["ember", "conference", "presentation", "keynote"]
isCJKLanguage = true
+++

我自己是 Ember 的忠实拥趸，即便目前的产品没有用 Ember 技术栈也会关注 Ember 生态圈里的最新动态。这个视频来自于 EmberConf 2016 的开场演讲，主讲者是 Yehuda Katz 和 Tom Dale 这俩位老搭档。

视频的前半段是回顾 2015，_25:00_ 往后开始讲对未来的展望了，我喜欢看这类型的内容。虽然说没人能够准确的预见未来，但是通过聆听这些站在行业尖端的人物们的分析和见解依然可以勾勒出未来的大致形状。技术工作者也是需要投资的，投资的不是金钱与物质而是对技术发展方向的预判从而合理分配学习和研究的精力。

## Web Apps 和 Mobile Apps

两位谈到了一个有趣的现状：你拿着手机正在浏览推特，看见有人分享了放在 Instagram上的有趣的图片。你点进去看看，进入了 Instaram 的网站，然后就提示你安装 Instagram App。好吧，你点击安装就跳转到了 App Store／Google Play 然后安装，网速不错的话这个时间相对也不算太长。终于装好了，你觉得可以看了吧？结果点开一看——找不到刚才人家分享的那个图片了……

这就是原生应用的尴尬之处。

尽管人们总是在强调原生应用的功能优势、性能优势、体验优势等等，但无法否认互联网的根基在于 Web，无论原生应用怎么折腾，人们获取信息的最主要渠道依然是 Web。Web 应用的劣势的确是客观存在的，但却是能通过技术发展逐个解决的。所以用发展性的眼光来看 Web 应用的前景反而是最光明的。

更重要的是过去两年人们不停地无情“批判”的 Web 应用的缺陷在现今其实都有了响应的技术解决方案，举例来说：

| Web 应用                 | 原生应用           |
| :----------------------- | :----------------- |
| （几乎）迅速开启         | 迅速开启           |
| （大部分）需要在线       | 离线可用           |
| （一些）设备特性访问受限 | 丰富的设备特性支持 |
| （一些）动效性能底下     | 快速，动效好       |

这样的列表还可以扩展下去，但无非就是两个层面：参与性（粘性）和体验性。在这两方面现在的 Web 应用技术已经可以做到接近甚至媲美原生应用技术的程度了。

- **Web 应用“落地”**：Service Worker／Add to Home Screen
- **消息推送**：Service Worker
- **快速启动**：Service Worker／App Cache
- **离线应用**：Service Worder／App Cache／IndexedDB

> App Cache 在 FireFox 44 时已经处于 deprecated 状态并且在未来将会被移除以便为 Service Worker 让道，而 Google Chrome 也附和了这一提议。因此 Service Worker 是离线应用的未来，而且它能做到的事情更多。

我非常惊讶且欣喜的看到 _Service Worker_ 的强大和普适性，它马上成为我的研究列表上排名前三的技术点之一。

同时我也想到自己在最近一段时间也曾分出一些精力去尝试了 React Native（或类似的）技术，不能否认它们会让你感觉很惊艳，但我也问过自己：**为什么我们要用 Web 的技术去追求创造原生应用呢？**或者反过来说为什么我们不继续大力发展 Web 技术让它在保持自身特色的同时进化到至少和原生应用平起平坐呢？

从这个角度出发你甚至会悚然发现：React Native 甚至是有点“短视”和“杀鸡取卵”的技术方向，至少在我看来它的生命周期不会太长，刚好是在这个“青黄不接”的时代的中间产物。

还有一些观点揪着 Web 框架的体积不放，说你们太大了打开都要花好久时间，怎么适合做应用呢？两位举了一个例子：原生的 Instagram iOS 应用有多大？**39.1MB** 

当你下载 Instagram 的时候怎么就不觉得大了呢？这事儿其实要从俩方面来讲。一方面的确是有太多的 Web App 仅仅只是把功能做出来了而已，很多方面的优化实在是不到位，所以回回打开回回慢自然无法给人带来好的观感印象；但另外一方面 Web App 的确是能够做到极速的，不仅仅是首次加载而已。可是 Web 的技术栈处在一个迅速发展不断变化的阶段，即便是专业从业者也只有很少的一部分可以完全拿得下、吃得住。

总之，Web Apps 的能力和潜力是够的，并且随着技术的发展它只会越来越好，更不要说它有一些先天优势是原生应用也好桌面应用也罢永远也无法媲美的，现阶段我们需要的不是选择去做哪个方向的指导性建议，而是一个足够好的技术栈和生态社区去带领我们发展和超越。Ember 是这个答案吗？我不能给出答案（不是没有答案，而是不能给出）。

## 平衡“功能”和“体积”

体积在一定意义上决定了功能的丰富性，这很好理解，而另一方面体积又对加载与启动速度有反作用。我们如何在不牺牲任何功能的前提下，约束应用的体积，或者说加速应用的加载与启动呢？

接下来的部分，Yehuda 和 Tom 讲述了 Ember 的计划，这个计划由六个技术点组成，依照应用程序的首次启动和后续启动分成两部分各负其责，它们分别是：

- **首次启动：** _FastBoot_, _Project Svelte_, _Engines_, _String Loading_
- **后续启动：** _Service Worker_, _String Loading_, _App Cache_

### FastBoot

FastBoot 是一个 Big Thing，早在一年前的 EmberConf 2015 就已经宣布启动了。其实FastBoot 就是服务端渲染技术，但它不是一个单一的技术而是许多技术的综合解决方案。最近我一直在做以 React 为中心的服务端渲染，其中所涉及到的技术难点还是比较了解的。不要脸的说，我对自己做出的成果还算满意吧，但是 FastBoot 所要应对的技术范围和应用场景要大得多——这可不是为了满足某个应用或某个团队的解决方案；更重要的是FastBoot 还会在社区的推动下不断的发展下去，比起个人项目，其能量和影响是不可同日而语的。

### Project Svelte

这里的 Project 主要是指 Ember 自身。自v2.4 开始 Ember 开启了 LTS 的版本计划，也正是从这个版本开始，Ember 将会彻底移除过去一直在 Deprecated 的部分代码，这部分代码的体积是相当可观的。

另外，Ember 的所有代码都将以 ES2015 Modules 的格式进行分发，以充分利用 Tree Shaking 技术（没错，就是 Webpack 2 也会有的 Tree Shaking）。还有一些不再需要的模块也将会被彻底清理掉。

### Engines

大体上可以将 Engines 视作按需加载的处理技术，应用代码将被很容易的分成若干个包，而用户只需要加载他们正在使用的部分的对应代码。

### String Loading

这是一个很有意思的举措，JavaScript 模块在分发时会以字符串的方式输出，于是只有真正被用到的模块代码才会产生解析求值的消耗。我不知道这对提升性能有多大的助益，回头有空去研究下里面的细节。

### Service Worker

它的作用主要体现在三方面：1）离线应用；2）精细化控制网络通信／数据传输；3）主动性资源预加载。

### App Cache

应用级别的缓存可以使得首次加载之后再也不需要下载静态资源，另外也可以做到应用程序自动升级。

---

我相信上面谈到的东西都不算是什么新鲜事物或是黑魔法了，只是它们在实践中还是甚少被用到。为什么？缺少领头羊，缺少真正可靠的整合型解决方案。Ember 会是答案吗？Well，我不能回答你啊。

接下来又回到了渲染性能的老话题了，在 Ember 的世界里也就是 Glimmer 了。Yehuda 展示了 Glimmer 2 的最新进展，结果当然是喜人的，渲染性能超过 React 2~3 倍（上千个组件不断 Update）。不过老实说我对这样的性能比较早就免疫了，现实中的开发渲染的性能瓶颈极少在框架的渲染引擎这里（除了做测试的极端例子之外）。换句话说，极端测试里能达到 60fps 并不能代表你做真实的项目就轻易能达到这个指标——你永远也不能指望一个框架帮你做到所有的事情。我们只能说 Glimmer 2 为我们打下了一个很好的基础，剩下的事还要靠我们自己。

## 总结

不管怎么说，就像 Tom 最后的总结一样：_The way we build web apps is changing_ 。而 Ember 的口号也正式变成了 _A SDK of Web_ ，这意味着我们已经走过了“如何去构建现代化 web 应用”的时代，正朝着“如何去构建更好的现代化 web 应用”进发。作为一个框架，Ember 已经交出了自己的答卷（打多少分是个人的事情，我给 90 分，剩下十分嘛……😸）；作为一个 SDK，Ember 正在路上，至少我是很期待着。
